<!Doctype html>
<html>
<head>
<title>Food</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script src="http://code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
<style type="text/css">
    #draggable { width: 90px; height: 90px;  float: left; margin: 0 10px 10px 0; border: 0px; }
    .ui-widget-header p, 
  #toolbar { float:left; border-style:solid; border-color:#000000; border-width:thin; width: 120px; height: 900px; margin-right:45px; background-color:grey}
  .container { float:left; border-style:solid; border-color:#000000; border-width:thin; width:80%; height:100px; }
  .dragger { width:100px; height:100px; }
  .tbutton { height: 100px}

</style>

<script type="text/javascript">
  $(function() {
  // adds fruit to container when dropped on it
  $(".container").droppable({
    drop: function(event, ui) {
      if (ui.draggable.hasClass("dragger")) {
          var $item = $(ui.helper).clone();
          $item.removeClass("dragger");
          $item.addClass("fruit");
          $(this).append($item);
          makeDraggable($item);
      }
      else if($(ui).parent().hasClass("container")){// 

          $(this).append($item);
          makeDraggable($item);
      } 
    }
  });
  // makes dropped fruit draggable again
  

  $(".dragger").draggable({ 
    helper: "clone" ,
    snap: ".container",
    grid: [ 50, 100],
    snapMode: "inner",
    start: function() {},
    stop: function() {
      console.log('stopped')
  }});
  
  
} );
function makeDraggable($item) {
     $item.draggable({
      snap: ".container",
      snapMode: "inner",
      //revert: true,
      grid: [ 20, 110],
      containment: "parent",
        start: function() {},
        stop: function() {
          console.log('stopped')
       }
     });
   }

function func($item){
  $item.droppable({
    drop: function(event, ui) {
      if (ui.draggable.hasClass("dragger")) {
          var $item = $(ui.helper).clone();
          $item.removeClass("dragger");
          $item.addClass("fruit");
          $(this).append($item);
          makeDraggable($item);
      }
      
    }
  });
}
function tracks() {
  var fruitlist = ["orange","apple","banana", "kiwi", "melon", "peach", "pear", "strawberry"]
for (let f = 0;f < fruitlist.length;f++){
    let fruit = document.getElementsByClassName(fruitlist[f]);
    let frtx = []; 
    let frty = [];
    for (let i = 1; i < fruit.length;i++){ // x and y of fruit
      frtx[i-1]=fruit[i].x
      frty[i-1]=fruit[i].y
    }
    let ytrk = frty.filter(onlyUnique); // y level of each track
    
    // makes 2nd array of where fruit are on each tracks
    var frttrk = []; 
    for (let j = 0; j < ytrk.length;j++){
      frttrk[j] = new Array();
    }

    for (let i = 0; i < frtx.length;i++){
        for (let j = 0; j < ytrk.length;j++){
          if (frty[i] == ytrk[j]){ // if y of fruit is y of track add it to frttrk[track#]
            frttrk[j].push(frtx[i]); 
          }
        }  
      }

    console.log(frttrk)
    }
    
}
function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}

function addTrack() {
  let x = $("<div class='container' ><button type='button' class='myBtn'  onclick='clearTrack(this.parentElement)' style='float: right;'>Clear track</button></div>")
  $("body").append(x);
  func(x);
}
function clearTrack(track){ // deletes fruit from track
  let fruits = track.childNodes;
  for (let i = 2; i < fruits.length; i++) {
    track.removeChild(fruits[i])
  }
}
  
  </script>
</head>

<body>
<div id="toolbar">
<div class="tbutton"><img class="dragger orange" src="https://www.sandjmandarins.com/wp-content/uploads/2019/03/Mandarin-Orange-PNG-Transparent-Image.png" width = 100px  ></div>
<div class="tbutton"><img class="dragger apple" src="https://purepng.com/public/uploads/large/purepng.com-fresh-applefoodsweettastyhealthyfruitappleleaf-981524677946vfurf.png" width = 100px height = 100px></div>
<div class="tbutton"><img class="dragger banana" src="https://www.pngall.com/wp-content/uploads/2016/04/Banana-Free-Download-PNG.png" width = 100px height = 100px></div>
<div class="tbutton"><img class="dragger kiwi" src="https://purepng.com/public/uploads/large/purepng.com-kiwikiwidrawingfruitfooddelicious-331522418479vgkh8.png" width = 100px height = 100px></div>
<div class="tbutton"><img class="dragger melon" src="https://pngimg.com/uploads/melon/melon_PNG14383.png" width = 100px height = 100px></div>
<div class="tbutton"><img class="dragger peach" src="https://freepngimg.com/thumb/peach/7-2-peach-png-pic.png" width = 100px height = 100px></div>
<div class="tbutton"><img class="dragger pear" src="https://purepng.com/public/uploads/large/bartlett-pear-avk.png" width = 67px height = 100px></div>
<div class="tbutton"><img class="dragger strawberry" src="https://static.wixstatic.com/media/2cd43b_181dba9bcee04be391e1d114f2744318~mv2.png/v1/fill/w_320,h_285,q_90/2cd43b_181dba9bcee04be391e1d114f2744318~mv2.png" width = 100px height = 100px></div>


</div>

<div class="container" > <button type='button' class='myBtn'  onclick='clearTrack(this.parentElement)' style='float: right;'>Clear track</button></div>
<div class="container" > <button type='button' class='myBtn'  onclick='clearTrack(this.parentElement)' style='float: right;'>Clear track</button> </div>
<button type="button" class="myBtn" onclick="tracks()">Fruits on each track logger</button>
<button type="button" class="myBtn" onclick="addTrack()">+track</button>

</body>
</html>